---
title: "R Notebook"
output: html_notebook
---
```{r}
library(ggpubr)
library(tidyverse)
```
```{r}
lab.dat <- mtcars %>% select(c('mpg', 'cyl', 'wt', 'hp'))
lab.dat$cyl <- as.factor(lab.dat$cyl)

pairs(lab.dat)
```
```{r}
formula <- mpg ~ cyl + wt + hp
mod.1 <- lm(formula, data = lab.dat)
summary(basic_lm)
```
Check assumptions: 
Normality 
```{r}
ggqqplot(mod.1$residuals)
```
Constant variance
```{r}
ggplot(mod.1, aes(.fitted, .resid)) +
  geom_point()
```


```{r}
empty.model <- lm(mpg~1, data=lab.dat)
full.model <- lm(mpg~.^2 + I(wt)^2+ I(hp)^2+ I(cyl)^2, data=lab.dat)

back.model <- step(empty.model,
                  scope = list(lower = empty.model,
                               upper = full.model),
                  direction = 'both',
                  data=lab.dat)
ggqqplot(back.model$residuals)
ggplot(back.model, aes(.fitted, .resid)) +
  geom_point()
```
```{r}
empty.model <- lm(mpg~1, data=lab.dat)
full.model <- lm(mpg~.^2 + I(wt)^2+ I(hp)^2+ I(cyl)^2, data=lab.dat)

back.model <- step(full.model,
                  scope = list(lower = empty.model,
                               upper = full.model),
                  direction = 'backward',
                  data=lab.dat)
ggqqplot(back.model$residuals)
ggplot(back.model, aes(.fitted, .resid)) +
  geom_point()
```




