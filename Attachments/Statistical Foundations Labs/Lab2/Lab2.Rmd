---
title: "Lab 2"
authors: "Charlie Jubera"
output: pdf_document
---

## Revisit the NormTemp dataset from Lab 1, where we examined the observed mean body temperature (temperature) in comparison to the well-known “average” of 98.6.
```{r message=FALSE}
library(UsingR)
library(tidyverse)
```

### Perform a statistical test (alpha = 0.05) to determine whether this well-known number is actually the mean body temperature. What is your p-value? Explain in words what this p-value means. What is your conclusion?

The p value of the one sample t-test is 2.411e-07, lower than our significance level, meaning that we reject the Null Hypothesis and average temperature is significantly different than 98.6 degrees
```{r}
library(UsingR)
t.test(normtemp$temperature, mu=98.6, alternative = 'two.sided', p.value=0.05)
```
### Give the 95% Confidence Interval for temperature. Explain in words what a 95% confidence interval represents.

A 95% confidnece interval is a range of values that we are 95% confident contains the true population parameter. 
```{r}
t.test(normtemp$temperature, mu=98.6, conf.level = 0.95)
```
## If we restrict our analysis to only the females in this dataset, would our conclusion change?

The confidence interval is closer to the 98.6 value, but the value is significantly different than the expected average temperature.
```{r}
fem_temp <- normtemp %>% filter(gender == 2) 
t.test(fem_temp$temperature, mu=98.6, conf.level = 0.95)
```

## Is there any difference (alpha=0.05) in temperature between the two genders recorded in this dataset (be sure to look at assumptions and perform the correct test)?

Assumptions:
- Normality of both groups: True, QQ-plot and Shapiro-Wilks show normality in both groups
- Independence between the groups: True, in this dataset there are no observations that are both male and female.
- Equal variance between groups

There is a significant difference in the average of temperature of the genders. 
```{r}
library(ggpubr)
normtemp <- normtemp %>% mutate(gender = as.factor(gender))
# Test normality
ggqqplot(normtemp, x="temperature", color = "gender")
shapiro.test(normtemp$temperature[normtemp$gender == 1])
shapiro.test(normtemp$temperature[normtemp$gender == 2])
# Test variance 
var.test(temperature~gender,data=normtemp)
t.test(temperature ~ gender, data=normtemp)
```
## The Airline dataset contains information regarding the number of international airline travelers (variable air) across different months of the year from 1949-1960. To obtain this data set, you will need to:
```{r}
data("AirPassengers")
```

### We are interested in knowing if during this time period there was a significant difference between air travel in the Summer months of June, July, and August vs. the remainder of the year? Use a statistical hypothesis test (alpha=0.05) to support your answer. In order to get month information, you will need to:

There is a significant difference in average air travel between the summer months and non-summer months
```{r}
# install.packages('tseries')
# install.packages('forecast')

library(tseries)
library(forecast)
cycle(AirPassengers)
air1 = data.frame(AirPassengers) 
air2 = air1 %>% mutate(summer=ifelse(cycle(AirPassengers) %in% 6:8,1,0))
air2$summer <- as.factor(air2$summer)
```
Normality
```{r}
ggqqplot(air2, x = 'AirPassengers', color='summer')
```
Equivariant: False
```{r}
var.test(AirPassengers~summer, data=air2)
```
```{r}
t.test(AirPassengers~summer, data= air2, var.equal = FALSE)
```





